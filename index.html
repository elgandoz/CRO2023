<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Waypoints CRO 2023</title>
  <script src="https://cdn.maptiler.com/maptiler-sdk-js/latest/maptiler-sdk.umd.min.js"></script>
  <link href="https://cdn.maptiler.com/maptiler-sdk-js/latest/maptiler-sdk.css" rel="stylesheet" />
  <style>
    body { margin: 0; padding: 0; }
    #map { position: absolute; top: 0; bottom: 0; width: 100%; }
  </style>
</head>
<body>
  <div id="map"></div>
  <script>
      maptilersdk.config.apiKey = 'Rbbu3nsbqSZW7WjHyQEk';
      const map = new maptilersdk.Map({
        container: 'map', // container's id or the HTML element to render the map
        style: "d07c7b14-599b-49eb-bb70-000a8f4984d6", // "topo" "topo-v2"
        center: [7.3021, 44.7922], // starting position [lng, lat]
        zoom: 11, // starting zoom
      });

      // const marker = new maptilersdk.Marker()
      //   .setLngLat([7.3021, 44.7922])
      //   .addTo(map);

      map.on('load', async function() {

        // load the icon image or use an image defined in the sprite
        // map.loadImage('https://docs.maptiler.com/openlayers/geojson-points/icon-plane-512.png', function(error, image){
        //   if (error) throw error;
        //   map.addImage('plane', image);
        // });

        const wptColor = '#007cbf'

        const geojson = await maptilersdk.data.get('8553c46e-c7a9-41bf-b2b2-8185528b6f93'); // CRO 2023 Dataset
        map.addSource('waypoints', {
          type: 'geojson',
          data: geojson
        });

        map.addLayer({
          'id': 'cro2023',
          'source': 'waypoints',
          'type': 'circle',
          'paint': {
              'circle-radius': 8,
              'circle-color': wptColor,
              'circle-stroke-color': '#fff',
              'circle-stroke-width': 2
          }
        });
        map.addLayer({
          id: 'WPTname',
          type: 'symbol',
          source: 'waypoints',
          // filter: ['has', 'point_count'],
          layout: {
            // 'text-field': '{name}',
            'text-field': ['format',
              ['get', 'name'], { 'font-scale': 1.5, 'font-weight': 800 },
              '\n',['get', 'desc'],' ',['get', 'ele'],'m',
            ],
            'text-font': ['Arial Unicode MS Bold', 'DIN Offc Pro Medium'],
            'text-size': 12,
            'text-variable-anchor': ['top', 'bottom', 'left', 'right'],
            'text-radial-offset': 0.5,
            'text-justify': 'auto',
          },
          'paint': {
            'text-color': wptColor,
            'text-halo-color': '#fff',
            'text-halo-width': 2,
          }
        });
      });
  </script>
</body>
</html>